services:
  app:
    image: local/{{project.name}}/dev:latest
    build:
      context: .
      target: "dev"
    command:
      - lein
      - repl
      - :headless
    ports:
      - mode: ingress
        target: 3000
        published: 3000
        protocol: tcp
      - mode: ingress
        target: 4001
        published: 4001
        protocol: tcp
      - mode: ingress
        target: 3449
        published: 3449
        protocol: tcp
    volumes:
      - type: bind
        source: ./app
        target: /app
        bind: {}
      - type: bind
        source: ~/.m2
        target: /root/.m2
        bind: {}
      - type: bind
        source: ~/.m2
        target: /home/hop/.m2
        bind: {}
