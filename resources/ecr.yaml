AWSTemplateFormatVersion: "2010-09-09"
Description: ""

Parameters:
  ProjectName:
    Description: "Project name"
    Type: "String"

Resources:
  EcrRepository:
    Type: "AWS::ECR::Repository"
    Properties:
       RepositoryName: !Sub "${ProjectName}"
       LifecyclePolicy:
         LifecyclePolicyText: |
          {
            "rules": [
              {
                 "rulePriority": 1,
                 "description": "Only keep latest 28 images",
                 "selection": {
                   "tagStatus": "any",
                   "countType": "imageCountMoreThan",
                   "countNumber": 28 },
                 "action": { "type": "expire" }}]
          }
